<html>
    <head>
        <link rel="stylesheet" type="text/css" href="styles.css" inline>
        <script src="floweditor.js" inline></script>
        <script src="node_definitions.js" inline></script>
        <script src="espeasy.js" inline></script>
    </head>
    <body>
        <div class="editor">
        </div>
        <script>
            getConfigNodes().then((devices, vars) => {
                devices.forEach(device => nodes.unshift(device));
                const ifElseNode = nodes.find(node => node.type === 'if/else');
                vars.forEach(v => ifElseNode.config[0].values.push(v));

                const chart = new FlowEditor(".editor", nodes, (config, rules) => {
                    storeConfig(config);
                    storeRule(rules);
                });

                loadConfig().then(config => {
                    chart.loadConfig(config);
                });
            });
            
        </script>
    </body>
</html>